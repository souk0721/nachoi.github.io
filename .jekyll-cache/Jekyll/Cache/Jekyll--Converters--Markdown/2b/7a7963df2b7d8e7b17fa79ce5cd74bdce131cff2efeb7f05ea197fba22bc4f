I"?<h1 id="í•„ìš”-ê°œë…">í•„ìš” ê°œë…</h1>
<ul>
  <li><code class="highlighter-rouge">ë°°ì¹˜íŒŒì¼</code> : <a href="/studynote/2018/07/02/basic-01.html">ë°°ì¹˜ íŒŒì¼ ë§Œë“¤ê¸°</a></li>
  <li><code class="highlighter-rouge">Powershell</code> : <a href="/studynote/2018/07/02/PowerShell-print-02.html">íŒŒì›Œì‰˜ ê¸°ë³¸ ë§Œë“¤ê¸°</a></li>
  <li><code class="highlighter-rouge">VBS</code> : <a href="/studynote/2018/07/04/basic-vbs-01.html">VBS ë§Œë“¤ê¸°</a></li>
</ul>

<h3 id="when">When?</h3>
<p>í•˜ë‚˜ì˜ íŒŒì¼ë¡œ ì—¬ëŸ¬ ìš´ì˜ì²´ì œì—ì„œ ë“œë¼ì´ë²„ë¥¼ ì„¤ì¹˜í•˜ê¸° ìœ„í•´ ì½”ë“œë¥¼ ì‘ì„±í–ˆìŠµë‹ˆë‹¤.</p>

<h3 id="how">How?</h3>
<ol>
  <li>ì§€ì • ëœ ê²½ë¡œ(ì—¬ê¸°ì„œëŠ” <code class="highlighter-rouge">c:\pcldrv</code>)ì— OS, Bitë³„ ë“œë¼ì´ë²„ ë¶„ë¥˜ í•˜ê¸°[ê·¸ë¦¼1]ì°¸ê³ 
    <ul>
      <li>windows7 : <code class="highlighter-rouge">c:\pcldrv\win7\PCL32</code>, <code class="highlighter-rouge">c:\pcldrv\win7\PCL64</code></li>
      <li>windows10 : <code class="highlighter-rouge">c:\pcldrv\win10\PCL32</code>, <code class="highlighter-rouge">c:\pcldrv\win10\PCL64</code>
<img src="/assets/post-img-18-07/Pinter-03.JPG" alt="print03" /></li>
    </ul>
  </li>
  <li>í”„ë¦°íŠ¸ í¬íŠ¸ í™•ì¸ í•˜ê¸°(ì´ë¯¸ì„¤ì¹˜ ëœ í¬íŠ¸ê°€ ìˆì–´ì•¼í•¨.ì—†ìœ¼ë©´ ì„¤ì¹˜í•„ìš”)
    <ul>
      <li><code class="highlighter-rouge">[Code]</code>ì—ì„œ <strong>$PrinterPortName</strong> ë³€ê²½
 <img src="/assets/post-img-18-07/Pinter-01.JPG" alt="print01" /></li>
    </ul>
  </li>
  <li>ì„¤ì¹˜ .INF íŒŒì¼ëª… ë³€ê²½
    <ul>
      <li>ì œì¡°ì‚¬ í”„ë¦°í„° ë“œë¼ì´ë²„ì˜ <code class="highlighter-rouge">.INF</code> íŒŒì¼ëª…</li>
      <li><code class="highlighter-rouge">[Code]</code>ì—ì„œ ì„¤ì¹˜ ë“œë¼ì´ë²„ì— ë§ëŠ” <strong>$InfName</strong> ë³€ê²½</li>
    </ul>
  </li>
  <li>ì„¤ì¹˜ í”„ë¦°íŠ¸ ë“œë¼ì´ë²„ëª… ë³€ê²½
    <ul>
      <li><code class="highlighter-rouge">[Code]</code>ì—ì„œ <strong>$DriverName</strong> ë³€ê²½ 
 <img src="/assets/post-img-18-07/Pinter-02.JPG" alt="print01" /></li>
    </ul>
  </li>
  <li><code class="highlighter-rouge">[Code]</code>ë¥¼ PowerShell íŒŒì¼ë¡œ ë§Œë“¤ê¸°
    <ul>
      <li><a href="/studynote/2018/07/02/PowerShell-print-02.html">íŒŒì›Œì‰˜ ê¸°ë³¸ ë§Œë“¤ê¸°</a></li>
    </ul>
  </li>
  <li><code class="highlighter-rouge">ìƒì„±í•œ PowerShell</code>íŒŒì¼ ë°°ì¹˜íŒŒì¼ë¡œ ì‹¤í–‰í•˜ê¸°
    <ul>
      <li>ë°°ì¹˜íŒŒì¼ì„ ë§Œë“¤ê³  ì•„ë˜ì˜ ëª…ë ¹ì¤„ ì‚½ì… <code class="highlighter-rouge">c:\pcldrv\test.ps1</code>ìì‹ ì— ë§ê²Œ ìˆ˜ì •</li>
      <li><a href="/studynote/2018/07/02/basic-01.html">ë°°ì¹˜ íŒŒì¼ ë§Œë“¤ê¸°</a>
        <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>PowerShell -Command "&amp; {Start-Process PowerShell -windowstyle hidden -ArgumentList '-NoProfile -ExecutionPolicy Unrestricted -File ""c:\pcldrv\test.ps1""' -Verb RunAs}";
</code></pre></div>        </div>
      </li>
    </ul>
  </li>
  <li>ì„ íƒ
    <ul>
      <li>CMDì°½ ì—†ì´ ë°± ê·¸ë¼ìš´ë“œë¡œ ì‹¤í–‰í•˜ë ¤ë©´
<a href="/studynote/2018/07/04/basic-vbs-01.html">VBS ë§Œë“¤ê¸°</a></li>
    </ul>
  </li>
</ol>

<p><br /></p>

<h3 id="code">Code?</h3>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>#ì´ê±´ ê·¸ëƒ¥ ë””í´íŠ¸ë¡œ ìê¸°ìì‹ ì„ ê°€ë¦¬í‚´.
$ComputerList = @(â€œ.â€)

#í”„ë¦°í„° í¬íŠ¸ì´ë¦„(ì´ë¯¸ ìƒì„± ëœ ê²ƒì„ ë°”íƒ•ìœ¼ë¡œ í•œë‹¤) - ìì‹ ì˜ í™˜ê²½ì— ë§ê²Œ ë³€ê²½
$PrinterPortName = â€œ165.244.227.25â€

#í”„ë¦°í„°ëª…(ì•„ë¬´ê±°ë‚˜ ìƒê´€ ì—†ìŒ) - ìì‹ ì˜ í™˜ê²½ì— ë§ê²Œ ë³€ê²½
$PrinterCaption = "MPS Driver" 

#í”„ë¦°í„°ë¥¼ ì„¤ì¹˜í•  ì„ íƒí•´ì•¼ í•˜ëŠ” ë“œë¼ì´ë²„ëª…[ê·¸ë¦¼2]ì—ì„œ ì•Œ ìˆ˜ìˆìŒ. - ìì‹ ì˜ í™˜ê²½ì— ë§ê²Œ ë³€ê²½
$DriverName = â€œSINDOH N600 Series PCL-8â€

#ë“œë¼ì´ë²„ ê²½ë¡œ
$Win7_64bit = "c:\pcldrv\win7\PCL64\"
$Win7_32bit = "c:\pcldrv\win7\PCL32\"
$Win10_64bit = "c:\pcldrv\win10\PCL64\"
$Win10_32bit = "c:\pcldrv\win10\PCL32\"

#ì„¤ì¹˜íŒŒì¼ Inf íŒŒì¼ëª… - ìì‹ ì˜ í™˜ê²½ì— ë§ê²Œ ë³€ê²½
$InfName = "KOAYFJA_.inf"

# ìì‹ ì˜ PC í™˜ê²½ì˜ OSì´ë¦„ì„ ë°˜í™˜ 
# ex)í•„ìëŠ” ìœˆë„ìš°10
# ë°˜í™˜ ê°’ : Microsoft Windows 10 Pro|C:\Windows|\Device\Harddisk0\Partition2
$OSCaption = (Gwmi Win32_OperatingSystem -ComputerName .).Name

#ì‹œìŠ¤í…œì´ 64bitì¼ê²½ìš° $OSbitê°€ Trueë¥¼ ë°˜í™˜
$OSbit = (Gwmi Win32_ComputerSystem -ComputerName .).SystemType -match â€˜(x64)â€™

function OSPath{
#ìœˆë„ìš°7ì¼ê²½ìš°
 if($OSCaption -match "windows 7"){
               Write-Host 'OS=windows7' -fore red
                  #64bitì¼ ê²½ìš°, OSbitê°€ Trueì¼ê²½ìš°
                 if($OSbit){
                    $DriverInf =  $Win7_64bit + $InfName
                    Write-Host 'OSbit=64' -fore red
                    return $DriverInf

                
                 }
                #32bitì¼ ê²½ìš°
                 else{
                    $DriverInf =  $Win7_32bit + $InfName
                    Write-Host 'OSbit=32' -fore red
                    return $DriverInf
                    
                 }

            
}
#ìœˆë„ìš° 10ì¼ ê²½ìš°
 if($OSCaption -match "windows 10"){
               Write-Host 'OS=windows10' -fore red
                 #64bitì¼ ê²½ìš°, OSbitê°€ Trueì¼ê²½ìš°
                 if($OSbit){
                 $DriverInf =  $Win10_64bit + $InfName
                 Write-Host 'OSbit=64' -fore red
                 return $DriverInf
                
                 }
                #32bitì¼ ê²½ìš°
                 else{
                 $DriverInf =  $Win10_32bit + $InfName
                 Write-Host 'OSbit=32' -fore red
                 return $DriverInf
                    
                 }
            
    }
}

Function CreatePrinter {
param ($PrinterCaption, $PrinterPortName, $DriverName, $ComputerName,$DriverInf)
        
       #í”„ë¦°í„°ë¥¼ ì„¤ì¹˜í•œë‹¤.
       CMD.EXE /C "printui.exe /if /b `"$PrinterCaption`" /f `"$DriverInf`" /r `"$PrinterPortName`" /m `"$DriverName`""
       Write-Host 'Print Create' -fore red
       sleep 5

       #ì„¤ì¹˜ëœ í”„ë¦°í„° ì˜¤ë¸Œì íŠ¸ë¥¼ ë‹´ëŠ”ë‹¤.
       $Printers =  Get-WmiObject -Class Win32_Printer -ComputerName .
       foreach($val in $Printers){
       $PrinterName = $val.name
       
       #ì„¤ì¹˜ëœ í”„ë¦°í„° ì¤‘ì— $PrinterCaptionì˜ í”„ë¦°í„°ëª…ì´ ìˆë‹¤ë©´
       if($PrinterName -like $PrinterCaption ){
       Write-Host 'New Print Find' -fore red
       
       #í•´ë‹¹ í”„ë¦°í„°ë¥¼ ê¸°ë³¸ í”„ë¦°í„°ë¡œ ì§€ì •í•œë‹¤.
       $val.SetDefaultPrinter()
       Write-Host 'Print Basic Setting' -fore red
       }

       }


   
  

}

foreach($computer in $ComputerList){
#OSPath í•¨ìˆ˜ë¥¼ ì‹¤í–‰í•˜ì—¬ ë“œë¼ì´ë²„ ê²½ë¡œë¥¼ retrun í•œë‹¤.
$DriverInfë¡œ = OSPath

#OSPathì—ì„œ returnë°›ì€ ë“œë¼ì´ë²„ ê²½ë¡œ ë° í”„ë¦°í„° ì„¤ì¹˜ ì„¤ì • ê°’ì„ ê°€ì§€ê³  í”„ë¦°í„°ë¥¼ ì„¤ì¹˜í•œë‹¤.
CreatePrinter -PrinterPortName $PrinterPortName -DriverName `
$DriverName -PrinterCaption $PrinterCaption -ComputerName $computer `
-DriverInf $DriverInf

}




</code></pre></div></div>
<h3 id="tip">Tip?</h3>

:ET